---
# file: provision.yml

- hosts: localhost
  tasks:
  - name: Add apt key
    apt_key: url={{item}} state=present
    with_items:
    - https://download.sublimetext.com/sublimehq-pub.gpg
    become: true

  - name: Add PPA repositories
    apt_repository: repo='{{item}}'
    with_items:
    - 'ppa:gnome-terminator' 
    - 'ppa:jonathonf/vim'
    - 'ppa:deluge-team/ppa'
    - 'ppa:team-xbmc/ppa'
    - 'deb https://download.sublimetext.com/ apt/stable/'
    - 'ppa:mozillateam/firefox-next'
    become: true

  - name: Install apt packages
    apt: pkg={{item}} state=present update_cache=true
    with_items:
    - apt-transport-https
    - ca-certificates
    - curl
    - software-properties-common
    - terminator
    - vim
    - deluge
    - sublime-text
    - trash-cli
    - gparted
    - git
    - kodi
    - kodi-peripheral-joystick
    - virtualbox
    - virtualbox-dkms
    - vagrant
    - inotify-tools
    - ntfs-3g
    - unrar
    - firefox
    become: true

  - name: Download packages
    get_url:
      url: '{{ item.url }}'
      dest: '/tmp/{{ item.name }}'
    with_items:
    - { name: 'android-studio.zip', url: 'https://dl.google.com/dl/android/studio/ide-zips/2.3.3.0/android-studio-ide-162.4069837-linux.zip' }
    - { name: 'google-chrome.deb', url: 'https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb' }
    - { name: 'gitkraken.deb', url: 'https://release.gitkraken.com/linux/gitkraken-amd64.deb' }
    - { name: 'anki.deb', url: 'https://apps.ankiweb.net/downloads/current/anki_2.0.47_all.deb' }

  - name: Install deb packages
    apt: deb='/tmp/{{ item }}.deb'
    with_items:
    - google-chrome
    - gitkraken
    - anki
    become: true
  
  - name: Install zip packages
    unarchive:
      src: /tmp/{{ item }}.zip
      dest: /opt
    with_items:
    - android-studio
    become: true

  - name: Create directories
    file:
      path: '{{ item }}'
      state: directory
      recurse: yes
    with_items:
    - '/home/vikash/.config/terminator/'
    - '/home/vikash/.local/share/applications/'

  - name: Move files
    file:
      src: '{{ playbook_dir }}/files/{{ item.file }}'
      dest: '{{ item.dest }}'
      state: link
      force: true
    with_items:
    - { file: 'vimrc', dest: '/home/vikash/.vimrc' }
    - { file: 'bashrc', dest: '/home/vikash/.bashrc' }
    - { file: 'bash-aliases', dest: '/home/vikash/.bash_aliases' }
    - { file: 'git-config', dest: '/home/vikash/.gitconfig' }
    - { file: 'terminator-config', dest: '/home/vikash/.config/terminator/config' }
    - { file: 'androidstudio.desktop', dest: '/home/vikash/.local/share/applications/androidstudio.desktop' }

#  - name: Run scripts
#    command: 'sh {{ playbook_dir }}/scripts/{{ item }}.sh'
#    with_items:
#    - auto-clean
